<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Editor</title>
    <link rel="icon" type="image/x-icon" href="https://mohan-chinnappan-n5.github.io/dfv/img/mc_favIcon.ico" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>


    <script src="https://mohan-chinnappan-n.github.io/sfdc/gs/js/split.js"></script>
    <link rel="stylesheet" href="https://mohan-chinnappan-n.github.io/sfdc/gs/css/split.css">

</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">&nbsp; SF-LAND Charts - Gantt - v2</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home</a>
            </li>
            </li>
          </ul>
        </div>
      </nav>
    <div class="split split-horizontal" id="menu">
        <table id="datatable" class="table table-bordered table-hover table-striped">
            <thead>
                <tr>
                    <th></th>
                    <th>Task Name</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Duration</th>
                    <th>Percent Completed</th>
                    <th>Dependencies</th>
                </tr>
            </thead>
            <tbody>
                <tr id="r1">
                    <td id="1-0A"><input id="1-0A" type="checkbox"/></td>
                    <td id="1-1">Spring 2023</td>
                    <td id="1-2D">2022-12-15</td>
                    <td id="1-3D">2023-02-13</td>
                    <td id="1-4"></td>
                    <td id="1-5">100</td>
                    <td id="1-6"></td>
                </tr>

                <tr id="r2">
                    <td ><input id="2-0A" type="checkbox"/></td>
                    <td id="2-1">Summer 2023</td>
                    <td id="2-2D">2023-05-05</td>
                    <td id="2-3D">2023-06-10</td>
                    <td id="2-4"></td>
                    <td id="2-5">0</td>
                    <td id="2-6">Spring2023</td>
                </tr>

                <tr id="r3">
                    <td ><input id="3-0A" type="checkbox"/></td>
                    <td id="3-1">Winter 2024</td>
                    <td id="3-2D">2023-8-11</td>
                    <td id="3-3D">2023-10-14</td>
                    <td id="3-4"></td>
                    <td id="3-5">0</td>
                    <td id="3-6">Summer2023</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="split split-horizontal" id="content">
        <p>Chart comes here</p>

    </div>


    <dialog id='edit-dialog' style="width:300px;">
        <h3>Edit</h3>
       
        <input id='dialog-input' type="text" value=""></input>
        <input id='dialog-input-date' type="date" value=""></input>
        <button class="btn btn-danger" id="delete-record">Delete</button>
        <button class="btn btn-success" id="add-record">Add</button>

        <hr/>
        <button class="btn btn-primary" id="close-dialog">Close</button>
    </dialog>


    <script>

        Split(["#menu", "#content"], { sizes: [60, 40] });


        const getEle = id => document.getElementById(id);
        const dialog = getEle('edit-dialog');
        const openButton = getEle('open-dialog');
        const closeButton = getEle('close-dialog');
        const dialogInput = getEle('dialog-input');
        const dialogInputDate = getEle('dialog-input-date');
        const dialogInputDelete = getEle('delete-record');
        const dialogInputAdd = getEle('add-record');
        const dataTable = getEle('datatable');
        console.log(dataTable);





        closeButton.addEventListener('click', e => {
            dialog.close();
        })

        dialogInput.addEventListener('change', e => {
            const eleId = event.target.dataset.src;
            const ele = getEle(eleId);
            ele.innerText = event.target.value;
        })
        dialogInputDate.addEventListener('change', e => {
            const eleId = event.target.dataset.src;
            const ele = getEle(eleId);
            ele.innerText = event.target.value;
        })

        dialogInputDelete.addEventListener('click', e => {
            const eleId = event.target.dataset.src;
            const ele = getEle(eleId);;
            ele.remove();
        })


        dialogInputAdd.addEventListener('click', e => {
            /*
            const eleId = event.target.dataset.src;
            const ele = getEle(eleId);;
            dataTable.insertRow();
            const eleRow = event.target.dataset.src;
            console.log(ele);   


            for (let i = 0; i < ele.cells.length; i++) {
                // Create a new cell in the new row
                const newCell = newRow.insertCell();
                // Set the content of the new cell to be the same as the original cell
                newCell.innerHTML = ele.cells[i].innerHTML;
              }
              */

        })


        const tdElements = document.querySelectorAll('table > tbody > tr > td');
        for (const ele of tdElements) {
            ele.addEventListener('click', e => {
                const trEle = ele.parentElement;
                const target = event.target;
                dialogInput.value = target.innerText;
                const eleId = target.getAttribute('id') 
                if (eleId.endsWith('A')) {
                    dialogInput.style.display ='none';
                    dialogInputDate.style.display ='none';
                    dialogInputDelete.style.display ='block';
                    dialogInputDelete.dataset.src = trEle.getAttribute('id');
                 }
                else if (eleId.endsWith('D')) {
                    dialogInputDate.dataset.src = target.getAttribute('id');
                    dialogInputDate.value = target.innerText;
                    dialogInput.style.display ='none';
                    dialogInputDelete.style.display ='none';
                    dialogInputDate.style.display ='block';

                }
                else {
                    dialogInput.dataset.src = target.getAttribute('id');
                    dialogInputDelete.style.display ='none';
                    dialogInputDate.style.display ='none';
                    dialogInput.style.display ='block';
                }
                dialog.showModal();
            })

        }
    </script>

</body>

</html>