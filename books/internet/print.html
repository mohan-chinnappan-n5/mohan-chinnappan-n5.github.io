<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>How the Internet Works: A Technical Perspective</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="chapter-1.html"><strong aria-hidden="true">2.</strong> Chapter 1: The User’s Request (Typing a URL)</a></li><li class="chapter-item expanded "><a href="chapter-2.html"><strong aria-hidden="true">3.</strong> Chapter 2: DNS Resolution</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="default-dns-server.html"><strong aria-hidden="true">3.1.</strong> Default DNS Server</a></li></ol></li><li class="chapter-item expanded "><a href="chapter-3.html"><strong aria-hidden="true">4.</strong> Chapter 3: Establishing a Connection (TCP/IP)</a></li><li class="chapter-item expanded "><a href="tcp_ip.html"><strong aria-hidden="true">5.</strong> Chapter 6: TCP/IP</a></li><li class="chapter-item expanded "><a href="sample-comm.html"><strong aria-hidden="true">6.</strong> Chapter 7: Sample Communication</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">How the Internet Works: A Technical Perspective</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>The internet is an intricate web of technologies, protocols, and infrastructures that work together to enable communication, data exchange, and interaction across the globe. For most people, using the internet is as simple as typing a URL into a web browser and viewing a webpage. But behind that simple action lies a series of complex steps involving a multitude of technologies. This book aims to break down the process from the technical person’s point of view, explaining what happens when a user types in a URL, from the moment they press “Enter” to when the webpage loads.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-1-the-users-request-typing-a-url"><a class="header" href="#chapter-1-the-users-request-typing-a-url">Chapter 1: The User’s Request (Typing a URL)</a></h1>
<p>When a user opens a web browser and types in a URL, they are essentially providing a request to access a resource on the internet. But what happens behind the scenes?</p>
<p>1.1 URL Parsing</p>
<p>The URL (Uniform Resource Locator) consists of several components:</p>
<ul>
<li>Scheme: Defines the protocol (e.g., http, https, ftp).</li>
<li>Host: This is the domain name (e.g., www.example.com).</li>
<li>Port: Optional, defines a network port (e.g., :80 for HTTP).</li>
<li>Path: The specific location of the resource on the server (e.g., /index.html).</li>
<li>Query String: Optional parameters sent to the server (e.g., ?id=123).</li>
<li>Fragment: A reference to a section within the page (e.g., #section2).</li>
</ul>
<p>1.2 DNS Lookup</p>
<p>The browser needs to convert the human-readable domain name (e.g., www.example.com) into an IP address, which the networking infrastructure can understand.</p>
<ul>
<li>DNS (Domain Name System) is like a phonebook for the internet. It maps domain names to IP addresses.</li>
<li>The browser first checks its cache to see if the domain name is already mapped to an IP. If not, it sends a DNS query to a DNS resolver.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-2-dns-resolution"><a class="header" href="#chapter-2-dns-resolution">Chapter 2: DNS Resolution</a></h1>
<p>Once the DNS query is made, several steps happen:</p>
<p>2.1 Recursive DNS Query</p>
<ul>
<li>The DNS resolver sends a request to one of the root DNS servers. The root servers point to TLD (Top-Level Domain) servers, which handle the domain’s extension (e.g., .com, .org).</li>
<li>The TLD servers then point to the authoritative DNS servers for the domain (e.g., example.com).</li>
</ul>
<p>2.2 Caching and Response</p>
<ul>
<li>The authoritative DNS server returns the IP address of the web server hosting the domain.</li>
<li>The DNS resolver returns this IP address to the user’s browser, and the browser caches it for future use</li>
</ul>
<h3 id="understanding-dns-queries-with-the-dig-command"><a class="header" href="#understanding-dns-queries-with-the-dig-command"><strong>Understanding DNS Queries with the <code>dig</code> Command</strong></a></h3>
<p>The <code>dig</code> (Domain Information Groper) command is a powerful tool used to query DNS servers for information about domain names, DNS records, and IP addresses. It helps network administrators, system engineers, and technical experts diagnose DNS issues by retrieving detailed information about DNS lookups.</p>
<p>Let’s break down the DNS query process using <code>dig</code> with some examples and explanations.</p>
<hr />
<h2 id="what-happens-in-a-dns-query"><a class="header" href="#what-happens-in-a-dns-query"><strong>What Happens in a DNS Query?</strong></a></h2>
<p>When you type a URL like <code>www.example.com</code> into your browser, your device needs to translate this human-readable domain into an IP address using DNS. The DNS resolution process involves several steps, including querying DNS servers to find the IP address corresponding to that domain. This process can be easily explored with the <code>dig</code> command.</p>
<hr />
<h2 id="basic-dig-command-syntax"><a class="header" href="#basic-dig-command-syntax"><strong>Basic <code>dig</code> Command Syntax</strong></a></h2>
<pre><code class="language-bash">dig [@server] [domain] [type] [options]
</code></pre>
<ul>
<li><code>@server</code>: The DNS server you want to query. If not provided, it uses the default DNS server configured on your system.</li>
<li><code>domain</code>: The domain name you want to query (e.g., <code>example.com</code>).</li>
<li><code>type</code>: The type of DNS record you want to query (e.g., <code>A</code>, <code>MX</code>, <code>NS</code>, <code>TXT</code>, etc.). If not provided, it defaults to querying <code>A</code> records.</li>
<li><code>options</code>: Additional options like <code>+short</code>, <code>+trace</code>, or <code>+noall</code>.</li>
</ul>
<hr />
<h3 id="example-1-basic-dns-query-for-a-record"><a class="header" href="#example-1-basic-dns-query-for-a-record"><strong>Example 1: Basic DNS Query for <code>A</code> Record</strong></a></h3>
<p>To perform a basic DNS lookup for the <code>A</code> record (IPv4 address) of <code>www.example.com</code>:</p>
<pre><code class="language-bash">dig www.example.com
</code></pre>
<h4 id="output-explanation"><a class="header" href="#output-explanation"><strong>Output Explanation:</strong></a></h4>
<pre><code class="language-text">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; www.example.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 58701
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1
;; QUESTION SECTION:
;; www.example.com.		IN	A
;; ANSWER SECTION:
www.example.com.	3600	IN	A	93.184.216.34
;; AUTHORITY SECTION:
example.com.		172800	IN	NS	a.iana-servers.net.
;; ADDITIONAL SECTION:
a.iana-servers.net.	172800	IN	A	199.43.135.53
</code></pre>
<h4 id="explanation-of-key-sections"><a class="header" href="#explanation-of-key-sections"><strong>Explanation of Key Sections:</strong></a></h4>
<ol>
<li><strong>QUESTION SECTION</strong>: The query you made (<code>www.example.com</code> for <code>A</code> records).</li>
<li><strong>ANSWER SECTION</strong>: The DNS server's response. In this case, it returns <code>93.184.216.34</code> as the IP address of <code>www.example.com</code>.</li>
<li><strong>AUTHORITY SECTION</strong>: Information about the authoritative DNS servers for the domain (<code>example.com</code>).</li>
<li><strong>ADDITIONAL SECTION</strong>: Additional information, such as the IP address of the authoritative server <code>a.iana-servers.net</code>.</li>
</ol>
<hr />
<h3 id="example-2-querying-for-a-specific-dns-record-type"><a class="header" href="#example-2-querying-for-a-specific-dns-record-type"><strong>Example 2: Querying for a Specific DNS Record Type</strong></a></h3>
<p>You can query specific types of DNS records with <code>dig</code>. For instance, if you want to retrieve the MX (Mail Exchange) records for <code>example.com</code>, you would use:</p>
<pre><code class="language-bash">dig example.com MX
</code></pre>
<h4 id="output-explanation-1"><a class="header" href="#output-explanation-1"><strong>Output Explanation:</strong></a></h4>
<pre><code class="language-text">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; example.com MX
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 58702
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1
;; QUESTION SECTION:
;; example.com.		IN	MX
;; ANSWER SECTION:
example.com.	3600	IN	MX	10 mx1.example.com.
;; AUTHORITY SECTION:
example.com.	172800	IN	NS	a.iana-servers.net.
;; ADDITIONAL SECTION:
a.iana-servers.net.	172800	IN	A	199.43.135.53
</code></pre>
<h4 id="explanation-of-output"><a class="header" href="#explanation-of-output"><strong>Explanation of Output:</strong></a></h4>
<ul>
<li><strong>ANSWER SECTION</strong>: The MX record for <code>example.com</code> shows that emails for the domain are handled by the server <code>mx1.example.com</code> with priority <code>10</code>.</li>
<li><strong>AUTHORITY SECTION</strong> and <strong>ADDITIONAL SECTION</strong> are similar to the previous example, giving more information about the authoritative nameservers.</li>
</ul>
<hr />
<h3 id="example-3-dns-query-for-a-specific-dns-server"><a class="header" href="#example-3-dns-query-for-a-specific-dns-server"><strong>Example 3: DNS Query for a Specific DNS Server</strong></a></h3>
<p>You can specify a custom DNS server using the <code>@</code> symbol to query. For example, to query Google's public DNS server (<code>8.8.8.8</code>) for the <code>A</code> record of <code>www.example.com</code>, use:</p>
<pre><code class="language-bash">dig @8.8.8.8 www.example.com
</code></pre>
<h4 id="output-explanation-2"><a class="header" href="#output-explanation-2"><strong>Output Explanation:</strong></a></h4>
<p>The process and output will be similar to the previous queries, but the DNS resolution is done by Google's public DNS server rather than the default system DNS.</p>
<hr />
<h3 id="example-4-using-short-for-a-simplified-output"><a class="header" href="#example-4-using-short-for-a-simplified-output"><strong>Example 4: Using <code>+short</code> for a Simplified Output</strong></a></h3>
<p>The <code>+short</code> option provides a more compact and concise output. For example:</p>
<pre><code class="language-bash">dig +short www.example.com
</code></pre>
<h4 id="output-explanation-3"><a class="header" href="#output-explanation-3"><strong>Output Explanation:</strong></a></h4>
<pre><code class="language-text">93.184.216.34
</code></pre>
<p>This stripped-down output only shows the IP address corresponding to <code>www.example.com</code> (the <code>A</code> record).</p>
<hr />
<h3 id="example-5-tracing-dns-resolution-with-trace"><a class="header" href="#example-5-tracing-dns-resolution-with-trace"><strong>Example 5: Tracing DNS Resolution with <code>+trace</code></strong></a></h3>
<p>The <code>+trace</code> option shows the full path of DNS resolution, starting from the root DNS servers down to the authoritative DNS server for the domain.</p>
<pre><code class="language-bash">dig +trace www.example.com
</code></pre>
<h4 id="output-explanation-4"><a class="header" href="#output-explanation-4"><strong>Output Explanation:</strong></a></h4>
<pre><code class="language-text">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; +trace www.example.com
.			172800	IN	NS	a.root-servers.net.
.			172800	IN	NS	b.root-servers.net.
...
example.com.		172800	IN	NS	a.iana-servers.net.
a.iana-servers.net.	172800	IN	A	199.43.135.53
www.example.com.	3600	IN	A	93.184.216.34
</code></pre>
<h4 id="explanation"><a class="header" href="#explanation"><strong>Explanation:</strong></a></h4>
<ul>
<li>The output shows the entire DNS lookup chain. It starts at the root DNS servers (<code>.</code>), then queries the TLD servers (<code>example.com</code>), and finally the authoritative DNS servers for <code>example.com</code>, which respond with the final <code>A</code> record (<code>93.184.216.34</code>).</li>
<li>This is helpful for debugging and understanding how DNS resolution works across different levels.</li>
</ul>
<hr />
<h3 id="example-6-dns-query-for-txt-records"><a class="header" href="#example-6-dns-query-for-txt-records"><strong>Example 6: DNS Query for TXT Records</strong></a></h3>
<p>You can query for <strong>TXT records</strong>, which are commonly used for SPF (Sender Policy Framework), DKIM (DomainKeys Identified Mail), or other metadata.</p>
<pre><code class="language-bash">dig example.com TXT
</code></pre>
<h4 id="output-explanation-5"><a class="header" href="#output-explanation-5"><strong>Output Explanation:</strong></a></h4>
<pre><code class="language-text">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; example.com TXT
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 58703
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1
;; QUESTION SECTION:
;; example.com.		IN	TXT
;; ANSWER SECTION:
example.com.	3600	IN	TXT	&quot;v=spf1 include:_spf.example.com ~all&quot;
</code></pre>
<h4 id="explanation-1"><a class="header" href="#explanation-1"><strong>Explanation:</strong></a></h4>
<ul>
<li><strong>ANSWER SECTION</strong>: The <code>TXT</code> record for <code>example.com</code> returns the SPF record, which defines which mail servers are authorized to send emails on behalf of <code>example.com</code>.</li>
</ul>
<hr />
<h2 id="key-options-and-modifiers-for-dig"><a class="header" href="#key-options-and-modifiers-for-dig"><strong>Key Options and Modifiers for <code>dig</code></strong></a></h2>
<ul>
<li><strong><code>+short</code></strong>: Outputs a simplified response, showing only the result (e.g., an IP address or hostname).</li>
<li><strong><code>+trace</code></strong>: Traces the DNS lookup process from root servers to the authoritative server.</li>
<li><strong><code>+noall</code></strong>: Suppresses all sections except the ones explicitly enabled with <code>+answer</code>, <code>+authority</code>, etc.</li>
<li><strong><code>+stats</code></strong>: Shows statistics like query time, server, and flags.</li>
<li><strong><code>+any</code></strong>: Queries for all available records for the domain.</li>
</ul>
<hr />
<h2 id="conclusion"><a class="header" href="#conclusion"><strong>Conclusion</strong></a></h2>
<p>The <code>dig</code> command is an essential tool for diagnosing DNS-related issues and understanding how the DNS query process works from a technical perspective. By using <code>dig</code>, network engineers can trace the journey of a DNS query, analyze the results, and troubleshoot DNS configurations with great detail. This chapter covered basic queries, advanced queries for different record types, and how to trace the DNS resolution process using <code>dig</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="default-dns-server"><a class="header" href="#default-dns-server">Default DNS Server</a></h1>
<h2 id="on-macos"><a class="header" href="#on-macos">On macOS</a></h2>
<p>cat /etc/resolv.conf</p>
<pre><code>#
# macOS Notice
#
# This file is not consulted for DNS hostname resolution, address
# resolution, or the DNS query routing mechanism used by most
# processes on this system.
#
# To view the DNS configuration used by this system, use:
#   scutil --dns (Manage system configuration parameters)
#
# SEE ALSO
#   dns-sd(1), scutil(8)
#
# This file is automatically generated.
#
nameserver 192.168.1.1
</code></pre>
<pre><code>scutil --dns 
</code></pre>
<pre><code>DNS configuration

resolver #1
  nameserver[0] : 192.168.1.1
  if_index : 11 (en0)
  flags    : Request A records
  reach    : 0x00020002 (Reachable,Directly Reachable Address)

resolver #2
  domain   : local
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 300000

resolver #3
  domain   : 254.169.in-addr.arpa
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 300200

resolver #4
  domain   : 8.e.f.ip6.arpa
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 300400

resolver #5
  domain   : 9.e.f.ip6.arpa
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 300600

resolver #6
  domain   : a.e.f.ip6.arpa
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 300800

resolver #7
  domain   : b.e.f.ip6.arpa
  options  : mdns
  timeout  : 5
  flags    : Request A records
  reach    : 0x00000000 (Not Reachable)
  order    : 301000

DNS configuration (for scoped queries)

resolver #1
  nameserver[0] : 192.168.1.1
  if_index : 11 (en0)
  flags    : Scoped, Request A records
  reach    : 0x00020002 (Reachable,Directly Reachable Address)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-3-establishing-a-connection-tcpip"><a class="header" href="#chapter-3-establishing-a-connection-tcpip">Chapter 3: Establishing a Connection (TCP/IP)</a></h1>
<p>With the IP address in hand, the browser is ready to establish a connection to the server.</p>
<p>3.1 TCP/IP</p>
<ul>
<li>
<p>The browser uses the Transmission Control Protocol (TCP) to ensure reliable data transmission between the client and the server. TCP ensures that the data is received in the <strong>correct order and retransmits any lost packets</strong>.</p>
</li>
<li>
<p>The browser uses IP (Internet Protocol) to route the packets of data between the client and the server over the internet.</p>
</li>
</ul>
<p>3.2 Three-Way Handshake (SYN, SYN-ACK, ACK)</p>
<p><img src="https://mohan-chinnappan-n5.github.io/books/web-perf/img/tcp-3way-hankdshake.png" alt="3 way handshake" /></p>
<p>Before data can be sent, a TCP connection is established between the browser and the web server using a process called the <strong>three-way handshake</strong>:</p>
<ol>
<li>The client (browser) sends a SYN (synchronize) packet to the server.</li>
<li>The server responds with a SYN-ACK (synchronize-acknowledge).</li>
<li>The client (browser) sends an ACK (acknowledge) to establish the connection.</li>
</ol>
<p>The three message mechanism is designed so that two computers that want to pass information back and forth to each other can negotiate the parameters of the connection before transmitting data such as HTTP browser requests.</p>
<p>This handshake step happens after a DNS lookup and before the TLS handshake, when creating a secure connection.</p>
<p>The connection can be terminated independently by each side of the connection via a four-way handshake, where a pair of FIN (finish) and ACK messages are sent and received independently by each side.</p>
<ul>
<li>The initiator sends a FIN packet to the other host.</li>
<li>The other host sends an ACK packet back to the initiator.</li>
<li>Now, the connection is half-closed, and the other host can still send data. (For example, the server can finish off sending data to the client when the client has closed its connection to the server.)</li>
<li>The other host sends a FIN packet to the initiator.</li>
<li>The initiator sends an ACK packet back to the other host.</li>
</ul>
<h2 id="tls-handshake"><a class="header" href="#tls-handshake">TLS handshake</a></h2>
<p>For secure connections established over HTTPS, another &quot;handshake&quot; is required.</p>
<p>This determines - which cipher will be used to encrypt the communication - verifies the server - establishes that a secure connection is in place before beginning the actual transfer of data</p>
<p><img src="https://mohan-chinnappan-n5.github.io/books/web-perf/img/ssl.jpg" alt="TLS Handshake" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-6-tcpip"><a class="header" href="#chapter-6-tcpip">Chapter 6: TCP/IP</a></h1>
<h3 id="tcpip-tutorial-understanding-the-basics-and-how-it-works"><a class="header" href="#tcpip-tutorial-understanding-the-basics-and-how-it-works"><strong>TCP/IP Tutorial: Understanding the Basics and How it Works</strong></a></h3>
<p>TCP/IP (Transmission Control Protocol/Internet Protocol) is the foundational suite of communication protocols that power the internet and most local networks. It's essential for data transmission between devices, ensuring reliable, efficient, and structured communication.</p>
<p>This tutorial will cover the following topics:</p>
<ol>
<li><strong>What is TCP/IP?</strong></li>
<li><strong>The OSI Model and the TCP/IP Model</strong></li>
<li><strong>How TCP/IP Works</strong></li>
<li><strong>Key Protocols in the TCP/IP Suite</strong></li>
<li><strong>Creating a TCP/IP Connection</strong></li>
<li><strong>Common Use Cases of TCP/IP</strong></li>
</ol>
<hr />
<h3 id="1-what-is-tcpip"><a class="header" href="#1-what-is-tcpip"><strong>1. What is TCP/IP?</strong></a></h3>
<p>TCP/IP stands for <strong>Transmission Control Protocol/Internet Protocol</strong>. It's a set of protocols that define how data should be packaged, addressed, transmitted, and received on a network. TCP/IP is essential for communication on the internet and within local area networks (LANs).</p>
<ul>
<li><strong>TCP (Transmission Control Protocol)</strong> ensures reliable, error-free communication between devices.</li>
<li><strong>IP (Internet Protocol)</strong> handles the addressing and routing of data packets across networks.</li>
</ul>
<p>Together, they allow devices to communicate in a consistent and structured way.</p>
<hr />
<h3 id="2-the-osi-model-and-the-tcpip-model"><a class="header" href="#2-the-osi-model-and-the-tcpip-model"><strong>2. The OSI Model and the TCP/IP Model</strong></a></h3>
<p>The <strong>OSI (Open Systems Interconnection) Model</strong> is a conceptual framework that standardizes the functions of a communication system into seven layers. TCP/IP roughly corresponds to the OSI model but uses fewer layers.</p>
<h4 id="the-osi-model-layers"><a class="header" href="#the-osi-model-layers"><strong>The OSI Model Layers:</strong></a></h4>
<ol>
<li><strong>Application Layer</strong>: User interface and application protocols (e.g., HTTP, FTP).</li>
<li><strong>Presentation Layer</strong>: Data translation and encryption (e.g., SSL/TLS).</li>
<li><strong>Session Layer</strong>: Maintains sessions or connections between devices.</li>
<li><strong>Transport Layer</strong>: Ensures end-to-end communication (e.g., TCP, UDP).</li>
<li><strong>Network Layer</strong>: Handles routing (e.g., IP).</li>
<li><strong>Data Link Layer</strong>: Manages physical addressing (e.g., Ethernet).</li>
<li><strong>Physical Layer</strong>: The hardware level (e.g., cables, switches).</li>
</ol>
<h4 id="the-tcpip-model-layers"><a class="header" href="#the-tcpip-model-layers"><strong>The TCP/IP Model Layers:</strong></a></h4>
<ol>
<li><strong>Application Layer</strong>: Similar to the OSI application, presentation, and session layers.</li>
<li><strong>Transport Layer</strong>: Contains protocols like TCP and UDP.</li>
<li><strong>Internet Layer</strong>: Corresponds to the OSI network layer (IP).</li>
<li><strong>Network Access Layer</strong>: Combines the OSI data link and physical layers.</li>
</ol>
<hr />
<h3 id="3-how-tcpip-works"><a class="header" href="#3-how-tcpip-works"><strong>3. How TCP/IP Works</strong></a></h3>
<p>TCP/IP operates by breaking data into packets, sending them over the network, and reassembling them at the destination. The communication process can be summarized in four basic steps:</p>
<ol>
<li>
<p><strong>Packetization</strong>: Data is broken into smaller, manageable packets. Each packet has headers containing metadata, including the source IP, destination IP, and sequence number.</p>
</li>
<li>
<p><strong>Routing</strong>: Packets are sent over the network, passing through various routers, switches, and other devices. Routers use the destination IP address to determine the best path to send the packet.</p>
</li>
<li>
<p><strong>Transmission</strong>: The packets are transmitted through various network layers and devices, with each layer performing specific tasks (e.g., error checking, routing, or data segmentation).</p>
</li>
<li>
<p><strong>Reassembly</strong>: Once the packets reach their destination, they are reassembled into the original message. TCP ensures the packets arrive in order, and any lost or corrupted packets are retransmitted.</p>
</li>
</ol>
<hr />
<h3 id="4-key-protocols-in-the-tcpip-suite"><a class="header" href="#4-key-protocols-in-the-tcpip-suite"><strong>4. Key Protocols in the TCP/IP Suite</strong></a></h3>
<p>Several protocols are involved in the functioning of TCP/IP. Let's explore the primary ones.</p>
<h4 id="1-transmission-control-protocol-tcp"><a class="header" href="#1-transmission-control-protocol-tcp"><strong>1. Transmission Control Protocol (TCP)</strong></a></h4>
<ul>
<li><strong>TCP</strong> provides reliable, connection-oriented communication. It ensures that data packets arrive at their destination in order, retransmits lost packets, and checks for errors.</li>
<li><strong>Three-way handshake</strong>: TCP establishes a connection using a three-way handshake:
<ol>
<li><strong>SYN</strong>: Client sends a synchronization packet to the server.</li>
<li><strong>SYN-ACK</strong>: Server acknowledges and synchronizes.</li>
<li><strong>ACK</strong>: Client acknowledges, and the connection is established.</li>
</ol>
</li>
</ul>
<h4 id="2-internet-protocol-ip"><a class="header" href="#2-internet-protocol-ip"><strong>2. Internet Protocol (IP)</strong></a></h4>
<ul>
<li><strong>IP</strong> is responsible for routing data packets to their destination based on the destination IP address.</li>
<li><strong>IPv4</strong>: The most widely used version of IP, uses 32-bit addresses (e.g., <code>192.168.1.1</code>).</li>
<li><strong>IPv6</strong>: A newer version of IP, uses 128-bit addresses to accommodate more devices.</li>
</ul>
<h4 id="3-user-datagram-protocol-udp"><a class="header" href="#3-user-datagram-protocol-udp"><strong>3. User Datagram Protocol (UDP)</strong></a></h4>
<ul>
<li>Unlike TCP, <strong>UDP</strong> is connectionless and doesn't guarantee reliable delivery. It's faster but less reliable, making it suitable for applications like video streaming or gaming.</li>
</ul>
<h4 id="4-domain-name-system-dns"><a class="header" href="#4-domain-name-system-dns"><strong>4. Domain Name System (DNS)</strong></a></h4>
<ul>
<li><strong>DNS</strong> is responsible for converting human-readable domain names (like <code>www.example.com</code>) into IP addresses that computers can understand.</li>
</ul>
<h4 id="5-hypertext-transfer-protocol-httphttps"><a class="header" href="#5-hypertext-transfer-protocol-httphttps"><strong>5. Hypertext Transfer Protocol (HTTP/HTTPS)</strong></a></h4>
<ul>
<li><strong>HTTP</strong> is used for transferring web pages and data over the internet.</li>
<li><strong>HTTPS</strong> is the secure version of HTTP, using SSL/TLS encryption.</li>
</ul>
<hr />
<h3 id="5-creating-a-tcpip-connection"><a class="header" href="#5-creating-a-tcpip-connection"><strong>5. Creating a TCP/IP Connection</strong></a></h3>
<p>Let’s go through a simplified example of a <strong>TCP/IP connection</strong> using Python to demonstrate how to establish a TCP connection between a client and a server.</p>
<h4 id="python-example-for-tcp-server-serverpy"><a class="header" href="#python-example-for-tcp-server-serverpy"><strong>Python Example for TCP Server (Server.py)</strong></a></h4>
<pre><code class="language-python">import socket

# Create a TCP/IP socket
server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Bind the socket to a specific address and port
server_socket.bind(('localhost', 65432))

# Listen for incoming connections
server_socket.listen()

print(&quot;Server is listening on port 65432&quot;)

# Wait for a connection
connection, client_address = server_socket.accept()

print(f&quot;Connected to {client_address}&quot;)

# Receive the data
data = connection.recv(1024)
print(f&quot;Received: {data.decode()}&quot;)

# Send a response
connection.sendall(b&quot;Hello from the server!&quot;)

# Close the connection
connection.close()
</code></pre>
<h4 id="python-example-for-tcp-client-clientpy"><a class="header" href="#python-example-for-tcp-client-clientpy"><strong>Python Example for TCP Client (Client.py)</strong></a></h4>
<pre><code class="language-python">import socket

# Create a TCP/IP socket
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to the server
client_socket.connect(('localhost', 65432))

# Send data to the server
client_socket.sendall(b&quot;Hello from the client!&quot;)

# Receive the response
data = client_socket.recv(1024)
print(f&quot;Received from server: {data.decode()}&quot;)

# Close the connection
client_socket.close()
</code></pre>
<h4 id="how-it-works"><a class="header" href="#how-it-works"><strong>How It Works:</strong></a></h4>
<ol>
<li>The <strong>server</strong> listens for incoming connections on port <code>65432</code> using <code>server_socket.accept()</code>.</li>
<li>The <strong>client</strong> connects to the server and sends a message.</li>
<li>The <strong>server</strong> receives the message and responds.</li>
<li>The client receives the server's response and both sockets are closed.</li>
</ol>
<hr />
<h3 id="6-common-use-cases-of-tcpip"><a class="header" href="#6-common-use-cases-of-tcpip"><strong>6. Common Use Cases of TCP/IP</strong></a></h3>
<ol>
<li>
<p><strong>Web Browsing (HTTP/HTTPS)</strong>: When you visit a website, your browser uses HTTP or HTTPS over TCP to request the webpage from the server. The server responds with the page data, and the browser displays it.</p>
</li>
<li>
<p><strong>Email (SMTP, POP3, IMAP)</strong>: Email servers and clients communicate using SMTP (Simple Mail Transfer Protocol) to send emails and POP3/IMAP to receive emails, all over TCP.</p>
</li>
<li>
<p><strong>File Transfer (FTP)</strong>: File Transfer Protocol (FTP) uses TCP to transfer files between computers over the internet.</p>
</li>
<li>
<p><strong>Remote Access (SSH, Telnet)</strong>: Secure Shell (SSH) and Telnet are used to remotely access and manage servers. They use TCP for establishing and maintaining a secure connection.</p>
</li>
<li>
<p><strong>Streaming (UDP)</strong>: Streaming services like Netflix or YouTube use UDP for transmitting real-time data, as it is faster but less reliable than TCP.</p>
</li>
</ol>
<hr />
<h3 id="conclusion-1"><a class="header" href="#conclusion-1"><strong>Conclusion</strong></a></h3>
<p>TCP/IP is the backbone of modern networking, enabling devices to communicate across the internet and local networks. From web browsing to file transfers, the protocols in the TCP/IP suite ensure that data is transmitted reliably and efficiently. Understanding how TCP/IP works will help you build more efficient networks and troubleshoot issues more effectively.</p>
<p>Whether you're developing network applications or troubleshooting connectivity problems, having a good grasp of TCP/IP is crucial for anyone working with networking technologies.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chapter-7-sample-communication"><a class="header" href="#chapter-7-sample-communication">Chapter 7: Sample Communication</a></h1>
<p>Here’s a simple, text-based explanation of what happens when a user uses a web browser to access www.google.com:</p>
<h3 id="1-user-types-url-wwwgooglecom"><a class="header" href="#1-user-types-url-wwwgooglecom">1. <strong>User Types URL: <code>www.google.com</code></strong></a></h3>
<p>The user enters the URL <code>www.google.com</code> in their browser's address bar. </p>
<hr />
<h3 id="2-dns-resolution-domain-name-system"><a class="header" href="#2-dns-resolution-domain-name-system">2. <strong>DNS Resolution (Domain Name System)</strong></a></h3>
<p>The browser needs to find the IP address for the domain <code>www.google.com</code> since it's easier for humans to remember domain names than IP addresses.</p>
<ul>
<li><strong>DNS Query</strong>: The browser sends a DNS request to the configured DNS server asking for the IP address of <code>www.google.com</code>.</li>
<li><strong>DNS Response</strong>: The DNS server responds with the IP address associated with <code>www.google.com</code> (e.g., <code>142.250.190.68</code>).</li>
</ul>
<p><strong>Diagram:</strong></p>
<pre><code>User -&gt; Browser -&gt; DNS Server (Request: www.google.com) -&gt; DNS Server (Response: 142.250.190.68)
</code></pre>
<hr />
<h3 id="3-establish-tcp-connection-tcp-handshake"><a class="header" href="#3-establish-tcp-connection-tcp-handshake">3. <strong>Establish TCP Connection (TCP Handshake)</strong></a></h3>
<p>Now that the browser knows the IP address of Google’s server, it needs to establish a connection with the server using TCP (Transmission Control Protocol).</p>
<p><strong>Three-Way Handshake</strong>:</p>
<ol>
<li><strong>SYN</strong>: The browser sends a SYN message (synchronize request) to the server.</li>
<li><strong>SYN-ACK</strong>: The server responds with a SYN-ACK message (synchronize-acknowledge).</li>
<li><strong>ACK</strong>: The browser acknowledges with an ACK message, completing the handshake.</li>
</ol>
<p><strong>Diagram:</strong></p>
<pre><code>Browser -&gt; SYN -&gt; Server
Server -&gt; SYN-ACK -&gt; Browser
Browser -&gt; ACK -&gt; Server
</code></pre>
<hr />
<h3 id="4-tls-handshake-establish-secure-connection"><a class="header" href="#4-tls-handshake-establish-secure-connection">4. <strong>TLS Handshake (Establish Secure Connection)</strong></a></h3>
<p>If the connection is over HTTPS, a TLS (Transport Layer Security) handshake begins to establish a secure, encrypted connection.</p>
<ol>
<li><strong>ClientHello</strong>: The browser sends a <code>ClientHello</code> message with supported encryption methods.</li>
<li><strong>ServerHello</strong>: The server responds with a <code>ServerHello</code> message and chooses an encryption method.</li>
<li><strong>Certificate Exchange</strong>: The server sends its digital certificate to the browser to prove its identity.</li>
<li><strong>Session Keys</strong>: The browser and server exchange keys to encrypt the communication.</li>
<li><strong>Finished</strong>: Both sides confirm that the secure connection is established.</li>
</ol>
<p><strong>Diagram:</strong></p>
<pre><code>Browser -&gt; ClientHello -&gt; Server
Server -&gt; ServerHello -&gt; Browser
Server -&gt; Certificate -&gt; Browser
Browser -&gt; Key Exchange -&gt; Server
Browser -&gt; Finished -&gt; Server
</code></pre>
<hr />
<h3 id="5-http-request"><a class="header" href="#5-http-request">5. <strong>HTTP Request</strong></a></h3>
<p>Now that the secure connection is established, the browser sends an HTTP request to the server to retrieve the content for the page.</p>
<p>Example of an HTTP GET request:</p>
<pre><code>GET / HTTP/1.1
Host: www.google.com
</code></pre>
<hr />
<h3 id="6-content-delivery"><a class="header" href="#6-content-delivery">6. <strong>Content Delivery</strong></a></h3>
<p>The server processes the request and sends back the requested HTML page, along with other resources like CSS, JavaScript, images, etc.</p>
<p><strong>Response:</strong></p>
<pre><code>HTTP/1.1 200 OK
Content-Type: text/html
</code></pre>
<p>The browser receives the content and begins rendering the webpage, which is displayed to the user.</p>
<hr />
<h3 id="summary"><a class="header" href="#summary">Summary</a></h3>
<pre><code>1. User enters URL -&gt; DNS Resolution -&gt; IP Address
2. Browser establishes TCP connection -&gt; Three-Way Handshake
3. TLS Handshake -&gt; Secure Connection
4. HTTP Request -&gt; Server Processes Request
5. HTTP Response -&gt; Content Delivered to Browser
6. Browser Renders Page for User
</code></pre>
<p>This text-based flow shows the core steps and protocols involved when you access a website like <code>www.google.com</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
